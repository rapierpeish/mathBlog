---
title: 2.3.1 DKT 薄板单元算例
categories: 力学
tags:
  - 力学
order: 5
---

考虑一个**各向同性、线弹性、小挠度薄板**，服从 **Kirchhoff–Love 板理论**。采用 **DKT（Discrete Kirchhoff Triangle）单元**进行离散。本讲义根据[[2.3 薄板单元静力问题]]，以一个任意三角形单元为例，使用工程简化方法，展示 DKT 的构造过程。

## 1. 单元几何定义

考虑任意三角形单元 $\Omega_{e}$​，其三个顶点坐标为：

- 节点 1：$(x_{1},x_{1})$
- 节点 2：$(x_{2},x_{y})$
- 节点 3：$(x_{3},x_{3})$

单元面积为：

$$
A = \frac{1}{2}\begin{vmatrix}1&x_{1}&y_{1} \\ 1&x_{2}&y_{2} \\ 1&x_{3}&y_{3} \end{vmatrix} =\frac{1}{2}(x_{2}-x_{1})(y_{3}-y_{1})-(x_{3}-x_{1})(y_{2}-y_{1})
$$

节点按逆时针顺序编号，保持三角形方向一致。

## 2. 节点自由度

每个节点 $i$ 具有 3 个自由度：

- $\omega_{i}$​：横向挠度（单位：*m*）
- $\theta_{x,i}$​：绕 $x$-轴的转角（*rad*）
- $\theta_{y,i}$：绕 $y$-轴的转角（*rad*）

$$
\theta_{x} = \frac{\partial \omega}{\partial x},\theta_{y} = \frac{\partial \omega}{\partial y}
$$

单元自由度向量为：$\mathbf{d}_{e} = [\omega_{1},\theta_{x_{1}},\theta_{y_{1}},\omega_{2},\theta_{x_{2}},\theta_{y_{2}}，\omega_{3},\theta_{x_{3}},\theta_{y_{3}}]^{T}$

## 3. 挠度场假设

DKT 假设单元内挠度为**完全二次多项式**：

$$
\omega(x,y) = a_{1}+a_{2}x+a_{3}y+a_{4}x^2+a_{5}xy+a_{6}y^2
$$

定义单项式基向量：

$$
\phi(x,y)=[1,x,y,x^2,xy,y^2]^{T}\Rightarrow \omega(x,y)=\phi(x,t)^{T}\mathbf{a},\mathbf{a}\in\mathbb{R}^6
$$

## 4. 约束条件构建

### 4.1 节点挠度插值

目标：建立 $\mathbf{a}$ 与 $\mathbf{d}_{e}$ 的关系。共需 6 个独立方程。

在三个节点处精确满足挠度：

$$
\omega(x_{i},y_{i}) = \omega_{i},i=1,2,3
$$

写成矩阵形式：

$$
\mathbf{L}_{\omega}\mathbf{a}=\mathbf{w}
$$

$$
\mathbf{L}_{\omega} = \begin{pmatrix}
1&x_{1}&y_{1}&x_{1}^2&x_{1}y_{1}&y_{1}^2 \\
1&x_{2}&y_{2}&x_{2}^2&x_{2}y_{2}&y_{2}^2  \\
1&x_{3}&y_{3}&x_{3}^2&x_{3}y_{3}&y_{3}^2 \\
\end{pmatrix}
$$

$$
\mathbf{w} = \begin{pmatrix}
\omega_{1} \\
\omega_{2} \\
\omega_{3}
\end{pmatrix}
$$

### 4.2 边中点离散 Kirchhoff 条件

对每条边 $e=(i,j)$，执行以下步骤：

#### 步骤 1：计算边中点坐标

$$
(x_{m}^{e},y_{m}^{e}) = (\frac{x_{i}+x_{j}}{2},\frac{y_{i}+y_{j}}{2})
$$


#### 步骤 2：计算单元内法向向量

边向量：$\mathbf{t}^{e}=(x_{j}-x_{i},y_{j}-y_{i})$

内法向:

$$
\mathbf{n}^{e} = \frac{1}{||\mathbf{t}^{e}||}(y_{i}-y_{j},x_{j}-x_{i})
$$

> 确保法向指向三角形内部（逆时针编号下）。

#### 步骤 3：计算法向导数（来自 $\omega$）

$$
\left. \frac{\partial \omega}{\partial n} \right|_{mid}^{e} = \nabla \omega (x_{m}^{e},y_{m}^{e}) \cdot \mathbf{n}^{e} = (\frac{\partial \phi}{\partial x}n_{x}^{e}+\frac{\partial \phi}{\partial y}n_{y}^{e})^{e}\mathbf{a}
$$

其中：

$$
\begin{align}
\frac{\partial \phi}{\partial x} &= [0,1,0,2x,y,0]^{T}  \\
\frac{\partial \phi}{\partial y} &= [0,0,1,0,x,2y]^{T}
\end{align}
$$

#### 步骤 4：计算插值得到的法向转角

节点 $i$ 处法向转角：

$$
\theta_{n,i}^{e} = \theta_{x,i}^{e} n_{y}^{e} + \theta_{y,i}^{e} n_{x}^{e}
$$

同理得 $\theta_{n,j}^{e}$:

$$
\theta_{n,j}^{e} = \theta_{x,j}^{e} n_{y}^{e} + \theta_{y,j}^{e} n_{x}^{e}
$$
​
中点线性插值：

$$
\theta_{n,mid}^{e} = \frac{1}{2}(\theta_{n,i}^{e}+\theta_{n,j}^{e})
$$

#### 步骤 5：施加约束

约束方程：

$$
(\nabla \phi(x_{m}^{e},y_{m}^{e})\cdot \mathbf{n}^{e})^{T} \mathbf{a} = \theta_{n,mid}^{e}
$$

对三条边 $e = [1,2],[2,3],[3,1]$ 重复上述过程，得到 3 个方程。

记这 3 个方程的系数矩阵为 $\mathbf{L}_{\theta}\in\mathbb{R}^{3\times 6}$，右端项为 $\mathbf{r}_{\theta}(\mathbf{d}_{e})\in\mathbb{R}^3$。

## 5. 完整约束系统

合并所有约束：

$$
\underbrace{\begin{pmatrix}\mathbf{L}_{\omega} \\\mathbf{L}_{\theta}\end{pmatrix}}_{\mathbf{L}\in\mathbb{R}^{6\times 6}}\mathbf{a} = \underbrace{\begin{pmatrix} \mathbf{w}\\ \mathbf{r}_{\theta}(\mathbf{d}_{e}) \end{pmatrix}}_{\mathbf{r}\in \mathbb{R}^{6\times 6}} 
$$

由于 $\mathbf{r}_{\theta}$​ 是 $\mathbf{d}_{e}$​ 的线性函数，存在矩阵 $\mathbf{M}\in\mathbb{R}^{6\times 9}$ 使得：

$$
\mathbf{r} = \mathbf{M} \mathbf{d}_{e}
$$
解得：

$$
\mathbf{a} = \mathbf{L}^{-1}\mathbf{M}\mathbf{d}_{e}
$$

### 5.1 构造 M 矩阵

在 DKT 单元中，矩阵 $M\in\mathbb{R}^{6\times 9}$ 是连接 自由度 $\mathbf{d}_{e}$ 与 约束右端项 $\mathbf{r}$ 的桥梁：

$$
\mathbf{r} = [\omega_{1},\omega_{2},\omega_{3},\theta_{n}^{mid,(12)},\theta_{n}^{mid,(23)}，\theta_{n}^{mid,(12)}]^{T}
$$

将 $\mathbf{M}$ 按行分块：

$$
\mathbf{M} = [\mathbf{M}_{\omega},\mathbf{M}_{\theta}]^{T}
$$

- $\mathbf{M}_{\omega} \in \mathbb{R}^{3\times 9}$ : 节点挠度部分
- $\mathbf{M}_{\theta} \in \mathbb{R}^{3\times 9}$ : 边中点法向转角部分

#### 5.1.1 上半部分

$$
\mathbf{M}_{\omega} = \begin{pmatrix}
1&0&0&0&0&0&0&0&0 \\
0&0&0&1&0&0&0&0&0 \\
0&0&0&0&0&0&1&0&0 
\end{pmatrix}
$$

#### 5.1.2 下半部分

##### 5.1.2.1 法向转角

对任意边 $e=(i,j)$，其**单位内法向向量**为：

$$
\mathbf{n}^{\left(ij\right)}=\frac{1}{L_{ij}}\begin{bmatrix}y_{i}-y_{j}\\ x_{j}-x_{i}\end{bmatrix}=\begin{bmatrix}n_{x}^{\left(ij\right)}\\ n_{y}^{\left(ij\right)}\end{bmatrix}
$$
$[x_{j}-x_{i},y_{j}-y_{i}]$ 是边向量，左右交换即逆时针旋转 90°，得到指向三角形边左侧的法向量，即外部法向量。所以需要添加负号，得到内向的法向量。

其中边长：

$$
L_{ij} = \sqrt{ (x_{j}-x_{i})^2+(y_{j}-y_{i})^2 }
$$

节点 $k$ 处的**法向转角**为：

$$
\theta_{n,k}^{ \left( ij \right)}= \theta_{x,k}n_{y}^{ \left( ij \right)}+ \theta_{y,k}n_{x}^{ \left( ij \right)}
$$

边中点处的法向转角通过线性插值得到：

$$
\theta_{n}^{\text{mid},(ij)}=\frac{1}{2}\left(\theta_{n,i}^{(ij)}+\theta_{n,j }^{(ij)}\right)=\frac{n_{y}^{(ij)}}{2}(\theta_{x,i}+\theta_{x,j})+\frac{n_{x} ^{(ij)}}{2}(\theta_{y,i}+\theta_{y,j})
$$

各边法向分量计算：

| 边   | $n_{x}^{ij}$                 | $n_{y}^{ij}$                 | 边长 $L_{ij}$                                         |
| --- | ---------------------------- | ---------------------------- | --------------------------------------------------- |
| 12  | $\frac{y_{1}-y_{2}}{L_{12}}$ | $\frac{x_{2}-x_{1}}{L_{12}}$ | $L_{12} = \sqrt{ (x_{2}-x_{1})^2+(y_{2}-y_{1})^2 }$ |
| 23  | $\frac{y_{2}-y_{3}}{L_{23}}$ | $\frac{x_{3}-x_{2}}{L_{23}}$ | $L_{23} = \sqrt{ (x_{3}-x_{2})^2+(y_{3}-y_{2})^2 }$ |
| 23  | $\frac{y_{3}-y_{1}}{L_{31}}$ | $\frac{x_{1}-x_{3}}{L_{31}}$ | $L_{31} = \sqrt{ (x_{1}-x_{3})^2+(y_{3}-y_{1})^2 }$ |

##### 5.1.2.2 构造 $\mathbf{M}_{\theta}$ 的行

自由度顺序为：

$$
\left[ w_{1}, \theta_{x1}, \theta_{y1}, w_{2}, \theta_{x2}, \theta_{y2}, w_{3}, \theta_{x3}, \theta_{y3} \right]
$$

第 4 行 边(12):

$$
\theta_{n}^{\text{mid,(12)}}=\frac{x_{2}-x_{1}}{2L_{12}}\theta_{x1}+\frac{y_{ 1}-y_{2}}{2L_{12}}\theta_{y1}+\frac{x_{2}-x_{1}}{2L_{12}}\theta_{x2}+\frac{y_{ 1}-y_{2}}{2L_{12}}\theta_{y2}
$$

$$
\left[0, \frac{x_{2}-x_{1}}{2L_{12}}, \frac{y_{1}-y_{2}}{2L_{12}}, 0, \frac{x_{2}-x_{1}}{2L_{12}}, \frac{y_{1}-y_{2}}{2L_{12}}, 0, 0, 0\right]
$$

第 5 行（边 23）：

$$
\theta_{n}^{\text{mid,(23)}}=\frac{x_{3}-x_{2}}{2L_{23}}\theta_{x2}+\frac{y_{ 2}-y_{3}}{2L_{23}}\theta_{y2}+\frac{x_{3}-x_{2}}{2L_{23}}\theta_{x3}+\frac{y_{ 2}-y_{3}}{2L_{23}}\theta_{y3}
$$

$$
\left[0, 0, 0, 0, \frac{x_{3}-x_{2}}{2L_{23}}, \frac{y_{2}-y_{3}}{2L_{23} }, 0, \frac{x_{3}-x_{2}}{2L_{23}}, \frac{y_{2}-y_{3}}{2L_{23}}\right]
$$

第 6 行（边 31）：

$$
\theta_{n}^{\text{mid,(31)}}=\frac{x_{1}-x_{3}}{2L_{31}}\theta_{x3}+\frac{y_{ 3}-y_{1}}{2L_{31}}\theta_{y3}+\frac{x_{1}-x_{3}}{2L_{31}}\theta_{x1}+\frac{y_{ 3}-y_{1}}{2L_{31}}\theta_{y1}
$$

##### 完整 $M$ 矩阵

$$
\mathbf{M}=\begin{bmatrix}1&0&0&0&0&0&0&0&0\\ 0&0&0&1&0&0&0&0&0\\ 0&0&0&0&0&0&1&0&0\\ 0&\dfrac{x_{2}-x_{1}}{2L_{12}}&\dfrac{y_{1}-y_{2}}{2L_{12}}&0&\dfrac{x_{2}-x_{1 }}{2L_{12}}&\dfrac{y_{1}-y_{2}}{2L_{12}}&0&0&0\\ 0&0&0&0&\dfrac{x_{3}-x_{2}}{2L_{23}}&\dfrac{y_{2}-y_{3}}{2L_{23}}&0&\dfrac{x_{3 }-x_{2}}{2L_{23}}&\dfrac{y_{2}-y_{3}}{2L_{23}}\\ 0&\dfrac{x_{1}-x_{3}}{2L_{31}}&\dfrac{y_{3}-y_{1}}{2L_{31}}&0&0&0&0&\dfrac{x_{1 }-x_{3}}{2L_{31}}&\dfrac{y_{3}-y_{1}}{2L_{31}}\end{bmatrix}
$$

其中：

$$
\begin{align}
L_{12}=\sqrt{(x_{2}-x_{1})^{2}+(y_{2}-y_{1})^{2}}\\  L_{23}=\sqrt{(x_{3}-x_{2})^{2}+(y_{3}-y_{2})^{2}}\\ L_{31}=\sqrt{(x_{1}-x_{3})^{2}+(y_{1}-y_{3})^{2}}
\end{align}
$$

## 6. 形函数表达式

挠度场可表示为：

$$
\omega(x,y)=\phi(x,y)^{T}\mathbf{a} = \underbrace{\phi(x,y)^{T}\mathbf{L}^{-1}\mathbf{M}\mathbf{d}_{e}}_{{N(x,y)\in \mathbb{R}^{1\times 9}}} 
$$

$$
\mathbf{a} =\mathbf{L}^{-1}\mathbf{M}\mathbf{d}_{e}
$$

## 7. 刚度矩阵计算

### 7.1 曲线向量

曲率向量定义为：

$$
\kappa=\begin{bmatrix}\kappa_{xx}\\ \kappa_{yy}\\ 2\kappa_{xy}\end{bmatrix}=-\begin{bmatrix}w_{xx}\\ w_{yy}\\ 2w_{xy}\end{bmatrix}=-\mathbf{B}\mathbf{d}_{e}
$$

$$
\mathbf{B}=\begin{bmatrix}
\phi_{x x}^T \\
\phi_{y y}^T \\
2\phi_{x y}^T
\end{bmatrix}\mathbf{L}^{-1}\mathbf{M}
$$

二阶导数基向量：

$$
\phi_{x x}^T=[0,0,0,2,0,0]^{T},\phi_{y y}^T=[0,0,0,0,0,2]^{T},\phi_{x y}^T=[0,0,0,0,1,0]^{T}
$$

### 7.2弹性矩阵

对于各向同性材料：

$$
\mathbf{D}=\frac{Eh^{3}}{12(1-\nu^{2})}\begin{bmatrix}1&\nu&0\\ \nu&1&0\\ 0&0&\dfrac{1-\nu}{2}\end{bmatrix}
$$

### 7.3 单元刚度矩阵

$$
\mathbf{K}_{e} = \int_{\Omega} \mathbf{B}^{T}\mathbf{D}\mathbf{B} d \Omega = A \cdot \mathbf{B}^{T}\mathbf{D}\mathbf{B}
$$

## 8. 节点等效受力计算

等效节点力计算依赖于虚功原理：外力在任意虚位移上所做的虚功，与原分布载荷在相同虚位移上所做的虚功完全相等。

### 8.1 基本定义

考虑一个三角形薄板单元 $\Omega_{e}$​，受横向分布载荷 $q(x,y)$。设单元的真实挠度场为 $\omega(x,y)$，其对应的虚位移场为 $\delta \omega (x,y)$。

**分布荷载虚功**

$$
\delta W_{ext} = \int_{\Omega} \delta \omega(x,y)^{T} q(x,y)  d \Omega
$$

$\delta W_{ext}$ 表示外力做的功是 $\delta \omega (x,y)$ 的一个泛函。在讨论最短弧长问题中，使用了相同的符号。

- 这里默认 $\omega(x,y),q(x,y)$ 都是列主向量

**等效节点力的虚功**

设等效节点力向量为：

$$
\mathbf{f}_{e}=[f_{\omega_{1}},f_{\theta_{x_{1}}},f_{\theta_{y_{1}}},f_{\omega_{2}},f_{\theta_{x_{2}}},f_{\theta_{y_{2}}},f_{\omega_{3}},f_{\theta_{x_{3}}},f_{\theta_{y_{3}}}]^{T}
$$

节点虚位移：

$$
\delta\mathbf{d}_{e}= [\delta \omega_{1},\delta \theta_{x_{1}},\delta \theta_{y_{1}},\delta \omega_{2},\delta \theta_{x_{2}},\delta \theta_{y_{2}},\delta \omega_{3},\delta \theta_{x_{3}},\delta \theta_{y_{3}}]^{T}
$$

等效节点力的虚功为:

$$
\delta W_{ext}^{'} = \delta \mathbf{d}_{e}^{T} \mathbf{f}_{e}
$$

在有限元分析中，位移场是以形函数 $\mathbf{N}(x,y)$ 为函数基底，节点位移 $\mathbf{d}_{e}$ 线性组合张成的空间 $\mathcal{P}$ :

$$
\mathcal{P} = \{\mathbf{N}(x,y)\mathbf{d}_{e}| \mathbf{d}_{e} \in \mathbb{R}^9 \}
$$


在 DKT 单元中，虚位移场 $\delta \omega(x,y)$ 由节点虚位移 $\mathbf{d}_{e}$ 插值得到：

$$
\delta \omega(x,y) = \mathbf{N}(x,y) \delta \mathbf{d}_{e}
$$

$\mathbf{N}(x,y) \in \mathbb{R}^9$ 是 DKT 的挠度场形函数矩阵，即 $\mathcal{P}$ 的函数基底。

根据等效条件，得到等效节点力的严格定义：

$$
\int_{\Omega} \delta \omega^{T} (x,y) q(x,y)  d \Omega =\delta \mathbf{d}_{e}^{T} \mathbf{f}_{e}
$$

代入得到**节点等效应的变分定义**：

$$
\int_{\Omega} \delta \mathbf{d}_{e}^{T} \mathbf{N}^{T}(x,y) q(x,y)  d \Omega =\delta \mathbf{d}_{e}^{T} \mathbf{f}_{e}
$$

- 这是在局部坐标$(x,y)$下的表达式，还需使用嵌入映射将节点等效力变换到世界 $\mathbb{R}^3$ 坐标系下。

### 8.2 薄板等效节点力公式

**等效节点力 $\mathbf{f}_{e}$**


从节点等效应的变分定义出发， $\delta \mathbf{d}_{e}$ 和 $d \Omega$ 无关，故可提出:

$$
\delta \mathbf{d}_{e} \int_{\Omega} \mathbf{N}^{T}(x,y) q(x,y)   d \Omega =  \delta\mathbf{d}_{e}^{T} \mathbf{f}_{e}
$$

故得到：

$$
\mathbf{f}_{e}^{T} = \int_{\Omega} \mathbf{N}^{T}(x,y) q(x,y)   d \Omega
$$

**形函数 $\mathbf{N}(x,y)$ **

根据之前的分析，挠度场和形函数关系满足：

$$
\omega(x,y) = \mathbf{N}(x,y) \mathbf{d}_{e} = \phi(x,y) \mathbf{a}
$$

> 再次申明：$\omega(x,y)$ 不是真实作用在二维流形 $M$ 上的挠度场$\omega(x,y)_{M}$，而是函数空间 $\mathcal{P}$ 上插值近似。

带入 $\mathbf{a} =\mathbf{L}^{-1}\mathbf{M}\mathbf{d}_{e}$ :

$$
\mathbf{N}(x,y) \mathbf{d}_{e} = \phi^{T}(x,y) \mathbf{L}^{-1}\mathbf{M}\mathbf{d}_{e}
$$

得到：

$$
\mathbf{N}(x,y)  = \phi(x,y)^{T} \mathbf{L}^{-1}\mathbf{M}
$$
将此公式带入得到：

$$
\mathbf{f}_{e}^{T} = \int_{\Omega} \mathbf{M}^{T}(\mathbf{L}^{-1})^{T}\phi(x,y) q(x,y)   d \Omega
$$

## 9.例题

### 9.1 例题1 三角单元计算示例

### 1.1 单元几何

考虑直角三角形单元，节点坐标如下：

| 节点  | x (m) | y (m) |
| --- | ----- | ----- |
| 1   | 0     | 0     |
| 2   | 1     | 0     |
| 3   | 0     | 1     |

单元面积：

$$
A = \frac{1}{2}
$$

- 计算点 $P=(0.2,0.3)$ 处的形函数 $N(0.2,0.3)$
- 计算均布载荷 $q_{0}​=1kN/m^2$ 下的等效节点力 $\mathbf{f}_{e}$

组装 $M$ 矩阵:

$$
\mathbf{M} = \begin{bmatrix}1&0&0&0&0&0&0&0&0\\ 0&0&0&1&0&0&0&0&0\\ 0&0&0&0&0&0&1&0&0\\ 0&0.5&0&0&0.5&0&0&0&0\\ 0&0&0&0&-\frac{1}{2\sqrt{2}}&-\frac{1}{2\sqrt{2}}&0&-\frac{1}{2\sqrt{2}}&- \frac{1}{2\sqrt{2}}\\ 0&0&0.5&0&0&0&0&0&0.5\end{bmatrix}
$$

数值近似：$\frac{1}{2\sqrt{ 2 }}\approx 0.3536$

组装 $\mathbf{L}$ 矩阵:

基函数$\phi(x,y)$：

$$
\phi(x,y)=[1,x,y,x^2,xy,y^2]^{T}
$$

基函数导数:

$$
\frac{\partial{\phi}}{\partial x}=[0,1,0,2x,y,0]^{\top},\quad\frac{\partial{\phi}}{\partial y}=[0,0,1,0,x,2y]^{\top}
$$

前三行节点约束：

- $\phi(0,0) = [1,0,0,0,0,0]^{T}$ 
- $\phi(1,0) = [1,1,0,1,0,0]^{T}$ 
- $\phi(0,1) = [1,0,1,0,0,1]^{T}$ 

后三行边中点约束：

| $e$ | 中点        | n                                   | $\phi_{x}$      | $\phi_y$        | $\phi_{n}$                                  |
| --- | --------- | ----------------------------------- | --------------- | --------------- | ------------------------------------------- |
| 12  | (0.5,0)   | (0,1)                               | [0,1,0,0,0,0]   | [0,0,1,0,0.5,0] | [0,0,1,0,0.5,0]                             |
| 23  | (0.5,0.5) | $(-1 / \sqrt{ 2 },-1 / \sqrt{ 2 })$ | [0,1,0,1,0.5,0] | [0,0,1,0,0.5,1] | [0,−0.7071,−0.7071,−0.7071,−0.7071,−0.7071] |
| 31  | (0,0.5)   | (1,0)                               | [0,1,0,0,0.5,0] | [0,0,1,0,0,1]   | [0,1,0,0,0.5,0]                             |

$$
\mathbf{L} = \begin{bmatrix}1&0&0&0&0&0\\ 1&1&0&1&0&0\\ 1&0&1&0&0&1\\ 0&0&1&0&0.5&0\\ 0&-0.7071&-0.7071&-0.7071&-0.7071&-0.7071\\ 0&1&0&0&0.5&0\end{bmatrix}
$$

$$
\mathbf{C} = \mathbf{L}^{-1}\mathbf{M} = \begin{bmatrix}1&0&0&0&0&0&0&0&0\\ 0&0.5&0&-1&0&0&0&0.5&0\\ 0&0&0.5&0&0&0&-1&0&0.5\\ 0&-0.5&0&1&0&0&0&-0.5&0\\ 0&0&0&0&0&0&0&0&0\\ 0&0&-0.5&0&0&0&1&0&-0.5\end{bmatrix}
$$

计算形函数$\mathbf{N}(0.2,0.3)=\phi^{T}\mathbf{C}$ :

$$
\mathbf{N}(0.2,0.3) = [0.96​,−0.02,​0.015,​0.02,​0.01,​−0.005,​0.02,0.005​,0.01]^{T}
$$

计算节点等效应力：

计算 $\mathbf{q}_{\phi}= q_{0}\int \phi d\Omega$ :

$$
\begin{split}\int 1d\Omega&=A=0.5\\ \int xd\Omega&=A\cdot\frac{0+1+0}{3}=0.5\cdot\frac{ 1}{3}=\frac{1}{6}\\ \int yd\Omega&=0.5\cdot\frac{1}{3}=\frac{1}{6}\\ \int x^{2}d\Omega&=\frac{A}{6}(0+1+0+0+0+0)=\frac{ 0.5}{6}=\frac{1}{12}\\ \int xyd\Omega&=\frac{A}{12}[0+0+0+0+1\cdot 1+0]= \frac{0.5}{12}=\frac{1}{24}\\ \int y^{2}d\Omega&=\frac{0.5}{6}=\frac{1}{12}\end{split}
$$

$$
\mathbf{q}_{\phi}=1\cdot\begin{bmatrix}0.5\\ 1/6\\ 1/6\\ 1/12\\ 1/24\\ 1/12\end{bmatrix}\approx\begin{bmatrix}0.5\\ 0.1667\\ 0.1667\\ 0.0833\\ 0.0417\\ 0.0833\end{bmatrix}
$$

代入支点等效力公式：

$$
\mathbf{f}_{e} = \mathbf{M}^{T} (\mathbf{L}^{-1})^{T} \mathbf{q}_{\phi}
$$

$$
\mathbf{f}_{e}\approx\begin{bmatrix}0.1667\\ 0.0208\\ -0.0208\\ 0.1667\\ -0.0208\\ 0.0208\\ 0.1667\\ 0.0208\\ 0.0208\end{bmatrix}
$$

校核

- 总竖向力： $\Sigma f_{\omega_{i}} = \int q d\Omega = 0.5$
- 总力矩（绕 x 轴）: $\Sigma(y_{i}f_{\omega_{i}}-f_{\theta_{x,i}})=\int yq d\Omega = 0.1667$
- 总力矩（绕 y 轴）: $\Sigma(-x_{i}f_{\omega_{i}}+f_{\theta_{y,i}})=\int -xq d\Omega = -0.1667$

### 9.2 例题2 悬臂板计算示例



