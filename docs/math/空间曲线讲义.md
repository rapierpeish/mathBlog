---
title: 1.空间曲线
categories: 微分几何
tags:
  - 微分几何
order: 1
createTime: 2026/01/07 22:15:46
permalink: /math/o9xir09s/
---


# 空间曲线的基本理论与Frenet标架

## 1. 正则空间曲线的定义
定义弧长参数曲线 $\mathbf{r}(s) = (x(s), y(s), z(s)) \in \mathbb{R}^3$ 为正则曲线，满足：
$$
\mathbf{r}'(s) \neq 0, \quad s \in (0,b)
$$
## 2. Frenet标架的构建

### (1) 单位切向量
$$
\mathbf{T}(s) = \frac{d}{ds}\mathbf{r}(s) \tag{1}
$$

### (2) 主法向量
$$
\mathbf{N}(s) = \frac{\mathbf{T}'(s)}{|\mathbf{T}'(s)|} \tag{2}
$$

### (3) 副法向量
$$
\mathbf{B}(s) = \mathbf{T}(s) \times \mathbf{N}(s) \tag{3}
$$

## 3. Frenet标架与微分方程
Frenet标架定义为：
$$
\text{Frenet} := \{\mathbf{T}, \mathbf{N}, \mathbf{B}\}
$$

其变化规律由Frenet-Serret公式描述：
$$
\frac{d}{ds}\begin{pmatrix} \mathbf{T} \\ \mathbf{N} \\ \mathbf{B} \end{pmatrix} =
\begin{pmatrix} 
0 & \kappa(s) & 0 \\ 
-\kappa(s) & 0 & \tau(s) \\ 
0 & -\tau(s) & 0 
\end{pmatrix}
\begin{pmatrix} \mathbf{T} \\ \mathbf{N} \\ \mathbf{B} \end{pmatrix} \tag{6}
$$

## 4. 曲率的推导

由(2)式可得：
$$
|\mathbf{T}'(s)|\mathbf{N}(s) = \mathbf{T}'(s) \tag{4}
$$
定义曲率 $\kappa(s)$：
$$
\kappa(s) \mathbf{N}(s) = \mathbf{T}'(s) \tag{5}
$$

> **几何意义**：曲率 $\kappa(s)$ 描述曲线弯曲程度，等于切向量变化率的大小。

## 5. 挠率的推导

### (1) 法向量的导数展开
由于 $\{\mathbf{T}, \mathbf{N}, \mathbf{B}\}$ 是正交标架，可将 $\mathbf{N}'(s)$ 表示为：
$$
\mathbf{N}'(s) = a(s)\mathbf{T}(s) + b(s)\mathbf{N}(s) + c(s)\mathbf{B}(s) \tag{7}
$$

### (2) 系数求解

**① 求$a(s)$:**
对(7)式两边点乘$\mathbf{T}$：
$$
\mathbf{N}'(s) \cdot \mathbf{T}(s) = a(s) \tag{8}
$$
由导数关系：
$$
\frac{d}{ds}(\mathbf{N} \cdot \mathbf{T}) = \mathbf{N}' \cdot \mathbf{T} + \mathbf{N} \cdot \mathbf{T}' = 0 \tag{9}
$$
结合(5)式：
$$
\mathbf{N}' \cdot \mathbf{T} + \kappa \mathbf{N} \cdot \mathbf{N} = 0 \Rightarrow a(s) = -\kappa(s) \tag{10}
$$

**② 求$b(s)$:**
对(7)式两边点乘$\mathbf{N}$：
$$
b(s) = 0 \quad \text{(因为$\mathbf{N}' \perp \mathbf{N}$)}
$$

**③ 求$c(s)$:**
定义挠率 $\tau(s)$：
$$
c(s) = \tau(s) = -\mathbf{N}'(s) \cdot \mathbf{B}(s)
$$

### (3) 最终表达式
$$
\mathbf{N}'(s) = -\kappa(s)\mathbf{T}(s) + \tau(s)\mathbf{B}(s)
$$

> **几何意义**：挠率 $\tau(s)$ 描述曲线偏离平面曲线的程度。

# 空间曲线的挠率与平面曲线的关系

## 定理
设 $\mathbf{r}(s)$ 是一条正则的空间曲线，参数为弧长 $s$。则：
$$
\tau(s) \equiv 0 \quad \text{（挠率恒为零）} \quad \iff \quad \mathbf{r}(s) \text{ 位于某个平面内}
$$
![](/docs/public/Pasted image 20250720223956.png)
## 证明

### 1. 必要性 ($\tau(s) = 0 \Rightarrow$ 平面曲线)
假设 $\tau(s) = 0$，根据 Frenet-Serret 公式：
$$
\frac{d\mathbf{B}}{ds} = -\tau(s) \mathbf{N} = 0
$$
因此副法向量 $\mathbf{B}(s)$ 是常向量 $\mathbf{B}_0$。

考虑 $\mathbf{r}(s)$ 与 $\mathbf{B}_0$ 的点积：
$$
\frac{d}{ds} (\mathbf{r}(s) \cdot \mathbf{B}_0) = \mathbf{T}(s) \cdot \mathbf{B}_0 = 0
$$
积分得：
$$
\mathbf{r}(s) \cdot \mathbf{B}_0 = D \quad \text{(常数)}
$$
即 $\mathbf{r}(s)$ 满足平面方程 $\mathbf{B}_0 \cdot \mathbf{r}(s) = D$，故为平面曲线。

### 2. 充分性 (平面曲线 $\Rightarrow \tau(s) = 0$)
设 $\mathbf{r}(s)$ 在平面 $\mathbf{a} \cdot \mathbf{r} = D$ 内，则：
$$
\mathbf{r}(s) \cdot \mathbf{a} = D
$$
对 $s$ 求导：
$$
\mathbf{T}(s) \cdot \mathbf{a} = 0
$$
再求导：
$$
\kappa(s) \mathbf{N}(s) \cdot \mathbf{a} = 0 \Rightarrow \mathbf{N}(s) \cdot \mathbf{a} = 0
$$
再求导：
$$
\frac{d\mathbf{N}}{ds} \cdot \mathbf{a} = 0
$$
由 Frenet-Serret 公式：
$$
(-\kappa(s) \mathbf{T}(s) + \tau(s) \mathbf{B}(s)) \cdot \mathbf{a} = 0 \Rightarrow \tau(s) \mathbf{B}(s) \cdot \mathbf{a} = 0
$$
因为 $\mathbf{B} \parallel \mathbf{a}$，所以 $\tau(s) = 0$。

# Bezier曲线自适应采样绘制曲线
## Bezier曲线介绍
### 数学表达式
$$
B(t) = Σ Bᵢ,ₙ(t) · Pᵢ, t ∈ [0,1]
$$
其中
- $Bᵢ,ₙ(t) = C(n,i) · tⁱ · (1-t)ⁿ⁻ⁱ$，$C(n,i)$是二项式系数，$B_{i,n}(t)$被称为伯恩斯坦多项式。
- $P_i$是控制点。

### 伯恩斯坦多项式性质介绍
#### 凸包性
注意到，Bezier曲线公式形式是一个[[仿射组合]]，因为$B_{i,n}>0$并且$\sum^{n}_{i = 0} B_{i,n}(t) = 1$ ，保证了贝塞尔曲线始终位于控制点的**凸包**内。这一性质在图形学中至关重要，因为它确保了曲线不会失控地偏离控制点。
#### 端点插值
伯恩斯坦基组合曲线**精确通过首尾控制点**，便于直观控制

基于以上两点原因：几何建模中更偏爱伯恩斯坦多项式。

## 弧长参数s转化一般参数t
## 1. 弧长参数下的曲率定义

对于以**弧长** $s$ 为参数的曲线 $\mathbf{r}(s)$，曲率定义为：

$$
\kappa(s) = \left\| \frac{dT}{ds} \right\| = \|\mathbf{r}''(s)\|
$$

其中：
- $T(s) = \mathbf{r}'(s)$ 是单位切向量
- $\|\mathbf{r}'(s)\| \equiv 1$ （弧长参数的性质）

## 2. 任意参数 $t$ 的转换推导

### 2.1 参数变换关系
对任意参数 $t$，弧长微分关系为：

$$
ds = \|\mathbf{r}'(t)\| dt \quad \Rightarrow \quad \frac{d}{ds} = \frac{1}{\|\mathbf{r}'(t)\|} \frac{d}{dt}
$$

### 2.2 切向量导数转换
单位切向量：

$$
T(t) = \frac{\mathbf{r}'(t)}{\|\mathbf{r}'(t)\|}
$$

对 $s$ 的导数：

$$
\begin{aligned}
\frac{dT}{ds} &= \frac{1}{\|\mathbf{r}'(t)\|} \frac{d}{dt} \left( \frac{\mathbf{r}'(t)}{\|\mathbf{r}'(t)\|} \right) \\
&= \frac{1}{\|\mathbf{r}'(t)\|} \left[ 
  \frac{\mathbf{r}''(t)}{\|\mathbf{r}'(t)\|} - 
  \frac{\mathbf{r}'(t)\cdot \frac{d}{dt} \|\mathbf{r}'(t)\|}{\|\mathbf{r}'(t)\|^2}
\right]
\end{aligned}
$$
计算$\frac{d}{dt} \|\mathbf{r}'(t)\|$ 
因为$\| \mathbf{r}^{'}(t) \|=\sqrt{\mathbf{r}^{'}(t) \cdot \mathbf{r}^{'}(t)}$ 
$$
   \frac{d}{dt}\|\mathbf{r}'(t)\| = \frac{\mathbf{r}'(t) \cdot \mathbf{r}''(t)}{\|\mathbf{r}'(t)\|}
   $$
合并结果
$$
   \frac{dT}{ds} = \frac{\mathbf{r}''(t)}{\|\mathbf{r}'(t)\|^2} - \frac{\mathbf{r}'(t) (\mathbf{r}'(t) \cdot \mathbf{r}''(t))}{\|\mathbf{r}'(t)\|^4}
   $$
### 2.3使用Python代码绘制贝塞尔曲线

脚本见bezier_adaptive_subdivision.py

![](/docs/public/Pasted image 20250724214858.png)
图1 使用均匀采样绘制绘制，采样数=100
![](/docs/public/Pasted image 20250724215603.png)
图2 使用曲率自适应采样绘制，采样数=50

曲率自适应采样的核心优势：
- 曲率是曲率是微分几何中的**内蕴量**，仅依赖于曲线自身的度量性质（如弧长参数、切向量变化率），与外部坐标系的选取无关。这一特性使得曲率自适应采样具有普适性。这个例子中采样方式对空间中的B样条曲线也同样适用。

# 参考资料
[1] (https://agg.sourceforge.net/antigrain.com/research/adaptive_bezier/)Adaptive Subdivision of Bezier Curves





