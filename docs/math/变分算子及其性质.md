---
title: 变分算子及其性质
categories: 微分几何
tags:
  - 微分几何
createTime: 2026/02/07 21:53:08
permalink: /math/lavsgr3d/
---

# 度量空间

设 $X$ 是一个非空集合，$d: X \times X \rightarrow \mathbb{R}$ 是一个距离函数。

如果 $d$ 满足以下四个条件，对于任意的 $x, y, z \in X$：

1. **非负性（Non-negativity）**：
   $$
   d(x, y) \geq 0
   $$
2. **恒等性（Identity of indiscernibles）**：
   $$
   d(x, y) = 0 \iff x = y
   $$
3. **对称性（Symmetry）**：
   $$
   d(x, y) = d(y, x)
   $$
4. **三角不等式（Triangle inequality）**：
   $$
   d(x, z) \leq d(x, y) + d(y, z)
   $$

则称二元组 $(X, d)$ 为一个[[度量空间]]，其中 $d$ 称为一个**度量（metric）**。

# 泛函

给定函数集合 $\mathcal{L}$ ，泛函 $J[f]$ 定义为：

$$
J[f] : \mathcal{L} \to \mathbb{R}
$$

泛函集合记为：$\mathcal{J}$

# 一阶 Sobolev 空间

一阶 Sobolev 空间定义为：

$$
H^1([0,1], \mathbb{R}^n)=\{\gamma:[0,1]\to \mathbb{R}^n|\gamma \in L^2([0,1],\mathbb{R}^n),\gamma^{'}\in L^2([0,1],\mathbb{R}^n)\}
$$

1. $\gamma$ 表示将$[0,1]$ 映射到 $\mathbb{R}^n$ 的路径函数。

2. $\gamma\in L^2$ 表示路径本身平方可积：

$$
\int_{0}^{1} || \gamma(t) ||^{2}dt<\infty
$$

3. $\gamma^{'}\in L^2$ 表示路径本身平方可积：

$$
\int_{0}^{1} || \gamma^{'}(t) ||^{2}dt<\infty
$$

一阶 Sobolev 空间即为满足上述三个性质的路径函数的集合。

在该空间中定义内积：

$$
\langle \gamma_1, \gamma_2 \rangle_{H^1} = \int_0^1 \gamma_1(t) \cdot \gamma_2(t) \, dt + \int_0^1 \gamma_1'(t) \cdot \gamma_2'(t) \, dt
$$

由此诱导范数与度量：

$$
\|\gamma\|_{H^1} = \left( \int_0^1 \|\gamma(t)\|^2 \, dt + \int_0^1 \|\gamma'(t)\|^2 \, dt \right)^{1/2}
$$

$$
d(\gamma_1, \gamma_2) = \|\gamma_1 - \gamma_2\|_{H^1}
$$

可以很容易证明 $d(\gamma_1, \gamma_2)$ 是满足度量定义的，此处略过。

# 微分流形

## 拓扑流形

设 $\mathcal{M}$ 是一个**豪斯多夫空间**（任意两点有不相交邻域），并且存在度量 $d: \mathcal{M} \times \mathcal{M} \to [0,\infty)$ 使得：

- $d(p,q)=0$ 当且仅当 $p=q$
- $d(p,q)=d(q,p)$
- $d(p,r) \leq d(p,q)+d(q,r)$

对于 $p \in \mathcal{M}$ 和 $r>0$，定义开球：

$$
B_{r}(p) = \{q\in\mathcal{M}|d(p,q)<r\}
$$

如果 $\mathcal{M}$ 满足：对于每个点 $p \in \mathcal{M}$，存在一个开球 $B_\epsilon(p)$ 和一个**双射**（一一对应）$\varphi_p: B_\epsilon(p) \to D^n$，其中 $D^n \subset \mathbb{R}^n$ 是某个开球（或更一般地，$\mathbb{R}^n$ 的开集），并且 $\varphi_p$ 是连续映射且逆映射也连续，那么 $\mathcal{M}$ 就是一个 **$n$维拓扑流形**。

更严格地说：存在一族开球 ${B_\alpha}_{\alpha \in A}$ 满足：

1. **覆盖条件**：$\bigcup_{\alpha \in A} B_\alpha = \mathcal{M}$
2. **局部欧几里得性**：对每个 $\alpha \in A$，存在双射 $\varphi_\alpha: B_\alpha \to D^n_\alpha$，其中 $D^n_\alpha$ 是 $\mathbb{R}^n$ 中的开球，且 $\varphi_\alpha$ 和 $\varphi_\alpha^{-1}$ 都连续。

## 微分流形

在拓扑流形 $\mathcal{M}$ 的基础上，如果开球族 ${B_\alpha}$ 和对应的映射 ${\varphi_\alpha}$ 还满足：

3. **相容性条件**：对任意两个开球 $B_\alpha$ 和 $B_\beta$，如果它们的交 $B_\alpha \cap B_\beta \neq \emptyset$，转移映射 $\eta$ 满足：
$$
\eta = \varphi_{\beta} \circ \varphi_{\alpha}^{-1}  :\varphi_{\alpha}(B_{\alpha}\cap B_{\beta})\to \varphi_{\beta}(B_{\alpha}\cap B_{\beta})
$$

$C^k$ 可微。那么拓扑流形 $\mathcal{M}$ 就是光滑可微的，称为微分流形。

# 函数空间的几何化

现在考虑一阶 Sobolev 空间 $H^1(\Omega)$，其中 $\Omega \subset \mathbb{R}^n$ 是有界开区域。

## 定义开球

对于 $f_0 \in H^1(\Omega)$，定义**开球**：

$$
B_{\epsilon}(f_{0}) = \{f \in H^1( \Omega)|d(f_{0},f)_{H^1}<\epsilon\}
$$

## 流形结构的验证

### 覆盖条件

 取所有有理点 $f_k \in H^1(\Omega)$ 和有理半径 $\epsilon_q > 0$，则开球族 ${B_{\epsilon_q}(f_k)}$ 的并覆盖整个 $H^1(\Omega)$

### 局部坐标映射

对每个开球 $B_\epsilon(f_0)$，构造映射：

$$
\varphi:B_{\epsilon}(f_{0})\to \ell ^2,\varphi(f)=\left\{\frac{\langle f-f_{0},\phi_{k} \rangle_{H^1} }{1-(||f-f_{0}||_{H^{1}})/\epsilon} \right\}_{k=1}^{\infty}
$$

#### 对公式的符号的解释

- $\varphi(f) \in \ell^2$：一个平方可和的无穷序列。
- 大括号 ${\cdots}_{k=1}^\infty$ 表示这是一个序列，$k$ 从 $1$ 到无穷

**分子部分**：$\langle f - f_0, \phi_k \rangle_{H^1}$

- $\phi_k$：$H^1$ 空间的一组**完备正交基函数**，$k=1,2,3,\dots$
- $\langle \cdot, \cdot \rangle_{H^1}$：$H^1$ 空间的内积

**内积的几何意义**：$\langle f - f_0, \phi_k \rangle_{H^1}$ 是偏移函数 $f-f_0$ 在基函数 $\phi_k$ 方向上的**投影坐标**（类似于傅里叶系数）

**分母部分**：$1 - | f - f_0 |_{H^1}/\epsilon$

$| f - f_0 |_{H^1}$：偏移函数的 $H^1$ 范数:

$$
\|\gamma\|_{H^1} = \left( \int_0^1 \|\gamma(t)\|^2 \, dt + \int_0^1 \|\gamma'(t)\|^2 \, dt \right)^{1/2}
$$

- $\epsilon$：开球的半径
- $(| f - f_0 |_{H^1})/\epsilon$：相对距离（取值在 $[0,1)$，因为 $f \in B_\epsilon(f_0)$）
- $1 - (| f - f_0 |_{H^1})/\epsilon$：趋近于边界时趋近于 $0$，在中心时等于 $1$

**整个分式的意义**

1. **保持有界性**：当 $f$ 接近球边界时，$| f - f_0 |_{H^1} \to \epsilon$，分母 $\to 0$，但分子也小（因为 $f$ 不能离 $f_0$ 太远），整体保持有界
2. **建立双射**：这个映射将开球 $B_\epsilon(f_0)$ **一一对应**到整个 $\ell^2$ 空间，而不是 $\ell^2$ 的一个有界子集
3. **边界行为**：球边界 $| f - f_0 |_{H^1} = \epsilon$ 被映射到无穷远

#### 证明映射是双射



### 光滑性

对于两个开球 $B_{\epsilon_1}(f_1)$ 和 $B_{\epsilon_2}(f_2)$，如果 $f \in B_{\epsilon_1}(f_1) \cap B_{\epsilon_2}(f_2)$，那么转移函数为：

$$
\varphi_{2} \circ \varphi_{1}^{-1} \left(\left\{a_{k} \right\}\right) = \left\{\frac{\left\langle f_{1} - f_{2} + \sum_{k=1}^{\infty} \tilde{a}_{k} \phi_{k}^{(1)} , \phi_{m}^{(2)} \right\rangle_{H^{1}}}{1 - \left\| f_{1} - f_{2} + \sum \tilde{a}_{k} \phi_{k}^{(1)} - f_{2} \right\|_{H^{1}} / \epsilon_{2}} \right\}_{m=1}^{\infty}
$$

其中 $\tilde{a}_k = a_k(1 - | \varphi_1^{-1}({a_k}) - f_1 |_{H^1}/\epsilon_1)$。这是一个光滑映射（实际上是解析的），因为它是线性运算和范数函数的复合。

## 函数空间上的切空间

对于 $f \in H^1(\Omega)$，取包含 $f$ 的开球 $B_\epsilon(f_0)$ 和对应的坐标映射 $\varphi$。

**切向量**：考虑通过 $f$ 的“曲线”，即映射 $c: (-\delta, \delta) \to H^1$ 满足 $c(0)=f$ 且 $c(t) \in B_\epsilon(f_0)$ 对所有 $t$。在坐标下：

$$
\varphi(c(t)) = {\alpha_{k}(t)}_{k=1}^{\infty}\subset\ell ^2
$$

**切向量定义**：曲线 $c$ 在 $f$ 处的切向量就是导数：

$$
c^{'}(0)=\frac{d}{dt}\Big|_{t=0}\varphi(c(t)) = \{a_{k}'(0)\}_{k=1}^{\infty} \in \ell^2
$$

**切空间**：所有这样的切向量构成的集合 $T_f(H^1)$ 自然地与 $\ell^2$ 同构，因而是一个希尔伯特空间。

# 变分算子的定义

## 函数空间上的几何结构

设 $\mathcal{M} = C^\infty(\mathbb{R}^n)$ 或 $H^1(\mathbb{R}^n)$ 是光滑函数空间，具有流形结构。对于任意 $f \in \mathcal{M}$：

(1) **切空间** $T_f\mathcal{M}$：所有通过 $f$ 的"曲线"在 $f$ 处的切向量构成的线性空间

(2) **切向量** $v \in T_f\mathcal{M}$ 可具体表示为**方向导数算子**：  

$$
v:C^{\infty}(\mathcal{M})\to\mathbb{R},v(F)=\frac{d}{dt}\Big|_{t=0} F(\gamma(t))
$$

其中 $\gamma: (-\epsilon,\epsilon) \to \mathcal{M}$ 满足 $\gamma(0)=f$, $\gamma'(0)=v$


## 变分算子的几何定义

考虑**泛函** $J: \mathcal{M} \to \mathbb{R}$，在 $f \in \mathcal{M}$ 处的**变分导数**（或第一变分）定义为：泛函 $J$ 在 $f$ 处的变分 $\delta J[f]$ 是 $J$ 在 $f$ 处的**微分**，即切空间上的线性泛函：

$$
\delta J[f]:T_{f}\mathcal{M}\to\mathbb{R},\delta J[f(v)]=dJ_{f}(v)
$$

对于任意切向量 $v \in T_f\mathcal{M}$，对应一个**变分函数** $\eta$，有：

$$
\delta J [f] (\eta) = \frac{d}{dt} \Big|_{t=0} J[f+t\eta]
$$

在这里变分函数 $\eta$ 就相当于是切空间中的 *方向*

## 变分导数算子

如果 $\delta J[f]$ 可以表示为**积分形式**：

$$
\delta J[f](\eta) = \int_{\Omega} \frac{\delta J}{\delta f}\eta(x)dx
$$

则称 $\frac{\delta J}{\delta f}(x)$ 为 $J$ 在 $f$ 处的**变分导数**（或泛函导数）。根据里斯表示定理，在 $L^2$ 内积下，切空间上的连续线性泛函 $\delta J[f]$ 对应唯一的**梯度函数** $\frac{\delta J}{\delta f} \in T_f\mathcal{M}$。

# 变分算子的性质

## 泛函乘积的定义

设 $F, G: \mathcal{M} \to \mathbb{R}$ 是两个泛函，定义它们的**点态乘积泛函** $FG: \mathcal{M} \to \mathbb{R}$ 为：

$$
(FG)[f] = F[f] \cdot G[f]
$$

这表示在每个 $f$ 处泛函值的乘积。

## 莱布尼茨法则

**定理**：对于任意 $f \in \mathcal{M}$ 和任意切向量 $\eta \in T_f\mathcal{M}$，有：

$$
\delta(FG)[f](\eta) = \delta F[f](\eta)  \cdot G[f]  + F[f] \cdot \delta G[f](\eta)
$$

等价变分导数写法：

$$
\frac{\delta(FG)}{\delta f} =  \frac{\delta F}{\delta f} \cdot G +F\cdot \frac{\delta G}{\delta F}
$$

### 基于切空间定义的证明

取任意曲线 $\gamma: (-\epsilon,\epsilon) \to \mathcal{M}$，$\gamma(0)=f$，$\gamma'(0)=\eta$。

根据变分算子的定义：

$$
\delta(FG)[f](\eta) = \frac{d}{dt}\Big|_{t=0} (FG)[\gamma(t)]
$$

根据泛函乘积的定义展开：

$$
(FG)[\gamma(t)]=F[\gamma(t)] \cdot G[\gamma(t)]
$$
使用微分形式的莱布尼茨法则：

$$
\frac{d}{dt}\Big|_{t=0} (FG)[\gamma(t)]=\frac{d}{dt}\Big|_{t=0}F[\gamma(t)] \cdot G[\gamma(t)] + F[\gamma(t)] \cdot \frac{d}{dt}\Big|_{t=0} G[\gamma(t)]
$$

带入变分定义：

$$
\delta F[f](\eta) = \frac{d}{dt}\Big|_{t=0}F[\gamma(t)],\quad \delta Gf](\eta) = \frac{d}{dt}\Big|_{t=0}G[\gamma(t)]
$$

得到：

$$
\delta(FG)[f](\eta) = \delta F[f](\eta)  \cdot G[f]  + F[f] \cdot \delta G[f](\eta)
$$

使用同样的方法可以推导出二阶变分 $\delta^2 J[f](\eta_1, \eta_2)$ 的莱布尼茨法则。二阶变分的概念对后续力学的学习至关重要。在力学讲义中，我将从能量角度出发，将刚度张量定义为应变能对应变张量的二阶变分，诱导几何刚度的概念，处理几何非线性问题。


