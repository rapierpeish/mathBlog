---
title: 1.一维流形上的弹性静力问题
categories: 力学
tags:
  - 力学
order: 1
description: 一维流形上的弹性静力问题
math: true
---

# 单根梁分析

**问题描述与基本假设**
考虑**欧拉-伯努利梁**模型：

- **几何**：长度为 $L$ 的均匀弹性直杆，横截面积为 $A$ ，截面惯性矩为 $I$
- **材料**：弹性模量 $E$ ，密度 $\rho$
- **荷载**：分布轴向力 $q(x) (0≤x≤L)$
- **约束**：端点$x=0$ 和 $x=L$ 处的几何或力学边界条件
- **待求**：轴向位移分布 $u(x)$

## 哈密顿原理

对于连续流形，哈密顿原理表述为

$$
\delta \int_{t_1}^{t_2} \mathcal{L} [u(x,t)] dt = 0
$$

流形的拉格朗日能量密度： 

$$
\mathcal{L}=\mathcal{T}−\mathcal{V}+\mathcal{W_{ext}​}
$$

其中：

- 运动能量密度：$\mathcal{T}=\frac{1}{2}​\rho A ( \frac{\partial u}{\partial t})^2$
- 应变能量密度：$\mathcal{V}=\frac{1}{2}EA (\frac{\partial u}{\partial x})^2$
- 外力做功输入能量密度：$\mathcal{W_{ext}​}=q(x)u(x)$

静力学简化
静力学问题中，惯性力为零，时间无关，故动能项消失。于是问题转化为计算函数空间下势能最小值，总势能为：
$$
II[u] = \int_{0}^{L} \left( \frac{1}{2}EA \left( \frac{\partial u}{\partial x} \right)^{2} - q(x)u(x) \right)
$$
对 $II[u]$ 求 *Gateaux* 导数，便可得到极值。

>  此处略过带入欧拉-拉格朗日方程求极值的过程

得到$u(x)$ 的通解形式：
$$
u(x) = -\frac{1}{EA} \int \int q(x)dx dx + \frac{C_{1}}{EA}x +C_{2}
$$

如果两端固定，均布荷载 $q_0$，边界条件为：​$u(0)=0,u(L)=0$，得到解：
$$
u(x) = \frac{q_{0}}{2EA}x(L-x)
$$

#  框架梁分析

**欧拉-伯努利梁的基本假设**
- 平截面假设：变形后横截面保持平面且垂直于中性轴
- 忽略剪切变形：适用于细长杆（长细比 > 10）
- 小变形：位移和转角均为小量
**位移场分解**：
- 轴向位移：$u(x)$ ，仅引起轴向应变
- 横向挠度：$w(x)$ ，引起弯曲应变曲率

我在此处将欧拉-伯努利梁抽象为1维流形，为了讨论梁的势能变换，需要讨论流形位移场的变化，为此我将流形位移场分解为轴向位移场和挠度位移场。通过讨论位移场得到应变场，进而将应力-应变联系起来。

## 位移场分析

### 轴向位移场

2节点杆单元，给定端点位移$u_{1},u_{2}$情况下，流形位移场插值为：

$$
u(t) = (1-t)u_{1}+tu_{2},t = \frac{x}{L} \in [0,1]
$$

> 这里做了个很简单的同伦映射。

将其改为矩阵形式：

$$
u(t)=\begin{pmatrix}N_{1}&N_{2}\end{pmatrix}\begin{pmatrix}u_{1} \\ u_{2}\end{pmatrix}=\mathbf{N}_{a}\mathbf{d}_{a}
$$

### 挠度位移场

挠度位移场必须保证曲率连续，采用三次 Hermite 插值：

$$
w(t) = \phi_{1}(t)w_{1}+\phi_{2}(t)\theta_{1}+\phi_{3}(t)w_{2}+\phi_{4}(t)\theta_{2}
$$

基函数$\phi$ 为：

- $\phi_{1}(t)=1-3t^2+2t^3$
- $\phi_{2}(t)=L(t-2t^2+t^3)$
- $\phi_{3}(t)=3t^2-2t^3$
- $\phi_{4}(t)=L(-t^2+t^3)$
- $w_{1},w_{2}$ 端点位移，$\theta_{1},\theta_{2}$ 为端点旋转量。

矩阵形式：

$$
w(t)=\begin{pmatrix}
\phi_{1}&\phi_{2}&\phi_{3}&\phi_{4}
\end{pmatrix}
\begin{pmatrix}
w_{1}\\ \theta_{1} \\ w_{2} \\ \theta_{2}
\end{pmatrix}=\mathbf{N}_{b}\mathbf{d}_{b}
$$

> 挠度位移场就是位移场的二阶协变导数

## 应变-位移关系

轴向应变：

$$
\epsilon_{x} = \frac{du}{dx}=\frac{d\mathbf{N}_{a}}{dx}\mathbf{d}_{a}=\mathbf{B}_{a}\mathbf{d}_{a}
$$

应变-位移矩阵$\mathbf{B}_{a}$：

$$
\mathbf{B}_{a}=\begin{pmatrix}
-\frac{1}{L}& \frac{1}{L}
\end{pmatrix}
$$

弯曲曲率：

$$
\kappa = \frac{d^2w}{dx^{2}}=\frac{d^2\mathbf{N}_{b}}{dx^2}\mathbf{d}_{b}=\mathbf{B}_{b}\mathbf{d}_{b}
$$

其中：

$$
\mathbf{B}_{b}=\frac{d^2\mathbf{N}_{b}}{dx^2}=\begin{pmatrix}
\frac{6-12t}{L^{2}}& \frac{4-6t}{L}&\frac{-6+12t}{L^2}&\frac{2-6t}{L}
\end{pmatrix}
$$

# 连续流形的能量

$$
U[\omega]=\int_{\mathcal{M}} \frac{1}{2}EI(w^{''})^{2}dx= \frac{1}{2}\langle \omega ^{''},\omega ^{''} \rangle _{EI} 
$$

函数内积定义：

$$
\langle \alpha,\beta \rangle_{EI} = \int_{\mathcal{M}} EI \alpha(x)\beta(x) dx
$$

单根梁的能量，即离散能量为：

$$
U_{h} = \frac{1}{2}\int_{\mathcal{M}}EI \kappa_{h}^{2(x)}dx
$$

- $U_{h}$ 符号中的下标 h 表示离散

$$
U_{h} = \frac{1}{2}\int_{\mathcal{M}}EI (\mathbf{B}(x)\mathbf{d})^2dx
$$

计算中间的二次型：

$$
(\mathbf{B}(x)\mathbf{d})^{2}=(\mathbf{d}^T\mathbf{B}^T(x))(\mathbf{B}(x)\mathbf{d})
=\mathbf{d}^T\mathbf{B}^T(x)\mathbf{B}(x)\mathbf{d}
$$

带入离散能量：

$$
U_{h} = \frac{1}{2} \mathbf{d}^T\left[\int_{\mathcal{M}}EI (\mathbf{B}^T(x)\mathbf{B}(x))dx\right]\mathbf{d}
$$

式中被方括号包裹的式子是曲率空间的内积度量矩阵，即刚度矩阵。这是包含拉压+弯曲能量的内积矩阵，对应自由度为 $u_{1},u_{2},\theta$ ：

$$
\mathbf{k}_{e}=
\begin{bmatrix}
\frac{EA}{L} & 0 & 0 & -\frac{EA}{L} & 0 & 0 \\
0 & \frac{12EI}{L^{3}} & \frac{6EI}{L^{2}} & 0 & -\frac{12EI}{L^{3}} & \frac{6EI}{L^{2}} \\
0 & \frac{6EI}{L^{2}} & \frac{4EI}{L} & 0 & -\frac{6EI}{L^{2}} & \frac{2EI}{L} \\
-\frac{EA}{L} & 0 & 0 & \frac{EA}{L} & 0 & 0 \\
0 & -\frac{12EI}{L^{3}} & -\frac{6EI}{L^{2}} & 0 & \frac{12EI}{L^{3}} & -\frac{6EI}{L^{2}} \\
0 & \frac{6EI}{L^{2}} & \frac{2EI}{L} & 0 & -\frac{6EI}{L^{2}} & \frac{4EI}{L}
\end{bmatrix}
$$

这是纯弯曲的的内积度量矩阵，对应自由度 $\omega_{1},\theta_{1},\omega_{2},\theta_{2}$ ：

$$
\mathrm{k}_{\mathrm{bend}}=\frac{EI}{L^{3}}
\begin{bmatrix}
12 & 6L & -12 & 6L \\
6L & 4L^{2} & -6L & 2L^{2} \\
-12 & -6L & 12 & -6L \\
6L & 2L^{2} & -6L & 4L^{2}
\end{bmatrix}
$$

考虑外荷载做的功$W_{ext}$ ：

$$
W_{ext} = \int_{\mathcal{M}}q(x)\omega (x) dx = \int_{\mathcal{M}} q(x) \mathbf{N}(x) \mathbf{d} dx = \mathbf{F}^{T}\mathbf{d}
$$

等效节点力：

$$
\mathbf{F} = \int_{\mathcal{M}} q(x) \mathbf{N}(x) dx
$$

总势能：

$$
II(\mathbf{d}) = \frac{1}{2}\mathbf{d}^T\mathbf{K}\mathbf{d}-\mathbf{F}^T\mathbf{d}
$$

取总势能关于自由度 $\mathbf{d}$ 的变分：

$$
\delta II = \frac{\partial{II}}{\partial \mathbf{d}} \delta \mathbf{d} = 0
$$

链式求导：

$$
\begin{align}
\delta\left( \frac{1}{2}\mathbf{d}^T\mathbf{K}\mathbf{d} \right)&=\mathbf{K}\mathbf{d}\delta \mathbf{d}\\
\delta(\mathbf{F}^T\mathbf{d})&=\mathbf{F}\delta \mathbf{d} \\
\delta II &= (\mathbf{K}\mathbf{d}-\mathbf{F})\delta
\end{align}
$$

由变分引理：

$$
\mathbf{K}\mathbf{d}-\mathbf{F} = 0
$$

建立全局刚度矩阵 $\mathbf{K}$
计算单元梁在有限元空间中的内积度量 $\mathbf{M}$ ，得到全局刚度矩阵$\mathbf{K}$ ：

$$
\mathbf{K}=(\mathbf{T}\mathbf{d}_{world})^T\mathbf{M}(\mathbf{T}\mathbf{d}_{world})=\mathbf{d}_{world}^T(\mathbf{T}^T\mathbf{M}\mathbf{T})\mathbf{d}_{world}
$$

- $\mathbf{T}$ 代表从全局坐标到局部坐标的变换

局部等效力 $\mathbf{F}_{eq}$ ：

$$
F_{eq} = \frac{L}{6}\begin{pmatrix}
2a+b \\ \frac{L(a-b)}{6} \\ a+2b \\ \frac{L(b-a)}{6}
\end{pmatrix}
$$

T矩阵
```
[ω₁]   [0  1  0  0  0  0][u₁]
[θ₁] = [0  0  1  0  0  0][v₁]
[ω₂]   [0  0  0  0  1  0][θ₁]
[θ₂]   [0  0  0  0  0  1][u₂]
                         [v₂]
                         [θ₂]
```

## 刚度矩阵

### Hodge星算子

在 $n$ 维[[联络#黎曼流形|黎曼流形]] $\mathbf{M}$上 ，Hodge算子作用于p-微分形式，将其映射为(n-p)-微分形式，本质是对偶化操作：

$$
\star:\Lambda^k(\mathbf{M})\to \Lambda^{n-k}(\mathbf{M})
$$

**连续Hodge星算子**定义了**微分形式**与**对偶形式**之间的**内积结构**：

$$
\alpha \wedge \star \beta = \langle \alpha,\beta \rangle vol_{g}
$$

**节点自由度**：每个节点 $i$ 有 3 个自由度
$$
\mathbf{d}_{i}= [u_{i},v_{i},\theta_{i}] ^T
$$

哈密顿原理离散化 = 轴向应变能量 + 弯曲应变能量

