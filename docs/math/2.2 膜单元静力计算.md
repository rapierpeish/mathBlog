---
title: 2.2 膜单元静力计算
categories: 力学
tags:
  - 力学
order: 3
createTime: 2026/01/07 22:45:22
permalink: /math/fp93w3dp/
---

二维膜单元计算讲义提要：
1. 给定三角单元 $ABC$，将顶点位移记做 $u$。通过线性插值，得到三角单元上所有点的位移值，即位移场。
2. 使用位移场和局部坐标构造应变张量，计算应变能
3. 使用位移场和外力场，计算节点等效应力

# 三角形单元上的位移场构造

考虑二维平面上的三角膜单元 $\triangle ABC$，其三个顶点分别为
$$
A(x_1,y_1),\quad B(x_2,y_2),\quad C(x_3,y_3)
$$
节点位移向量
$$
\mathbf{u} = [u_1, v_1,\; u_2, v_2,\; u_3, v_3]^T
$$
采用 **线性插值** 在三角单元内部构造位移场：

$$
\begin{align}
u(x,y) &= N_1(x,y)u_1 + N_2(x,y)u_2 + N_3(x,y)u_3\\
v(x,y) &= N_1(x,y)v_1 + N_2(x,y)v_2 + N_3(x,y)v_3
\end{align}
$$

三角形线性形函数为：
$$
N_i = \frac{1}{2A}(a_i + b_i x + c_i y),\quad i=1,2,3
$$

$A$ 为三角形面积。
系数：
$$
\begin{aligned} b_1 &= y_2 - y_3, & c_1 &= x_3 - x_2\\ b_2 &= y_3 - y_1, & c_2 &= x_1 - x_3\\ b_3 &= y_1 - y_2, & c_3 &= x_2 - x_1 \end{aligned}
$$

这里构造了函数空间 $\mathcal{V}=span\{N_{1},N_{2},N_{3}\}$ 来描述三角片单元。接下来按照一维流形步骤，构造应变-位移矩阵 $\mathbf{B}$ 用来计算函数空间 $\mathcal{V}$ 上的应变能。

# 构造应变-位移矩阵 $\mathbf{B}$

定义位移梯度场 $\nabla N_{i}=(r_{i,x},r_{i,y})^T$：
$$
r_{i,x}=\frac{b_{i}}{2A},\quad r_{i,y}=\frac{c_{i}}{2A}
$$

这里使用柯西线性应变张量$\varepsilon_{ij}$ 构造应变-位移矩阵 $\mathbf{B}$ ：

$$
\varepsilon_{ij}= \frac{1}{2}(\mathbf{r}_{i} \cdot \mathbf{u}_{j}+\mathbf{r}_{j} \cdot \mathbf{u}_{i})
$$

位移场由函数空间$\mathcal{V}$ 的基函数（形函数）线性插值得到：
$$
\mathbf{u}(x,y)=\sum_{k=1}^{3} N_k(x,y)\,\mathbf{u}_k
$$

$\mathbf{u}_k=(u_k,v_k)^T$ 是第 $k$ 个节点的位移向量。

柯西小应变分量为：
$$
\varepsilon_{pq}=\tfrac12\Big(\frac{\partial u_p}{\partial x_q}+\frac{\partial u_q}{\partial x_p}\Big), \qquad p,q\in\{x,y\}
$$

> 这里为了照顾指标写法，x对应 $x_{1}$，y 对应 $x_{2}$

把位移场$\mathbf{u}(x,y)$代入：
$$
\frac{\partial u_p}{\partial x_q} = \sum_{k=1}^3 \frac{\partial N_k}{\partial x_q}\,u_{k,p} = \sum_{k=1}^3 r_{k,q}\,u_{k,p}
$$

$u_{k,p}$ :节点 k 在方向 q 上的位移分量

带入 $\varepsilon_{pq}$ ：
$$
\varepsilon_{pq}= \frac{1}{2}\sum_{k=1}^{3} (r_{k,q}\,u_{k,p} + r_{k,p}u_{k,q})
$$

计算 $\mathbf{B}$ :

计算 $\varepsilon_{11},\varepsilon_{22},\gamma_{12}=2\varepsilon_{12}$
$\varepsilon_{11} = \sum r_{k,1}u_{k,1}$  
$\varepsilon_{22}= \sum r_{k,2}u_{k_{2}}$
$\gamma_{12}=\sum (r_{k,1}u_{k,2}+r_{k,2}u_{k,1})$

把这些表达写成矩阵形式 $\boldsymbol{\varepsilon}=B\mathbf{u}$。按节点自由度排列 $[u_1,v_1,u_2,v_2,u_3,v_3]^T$，$B$ 的行对应 $\varepsilon_x,\varepsilon_y,\gamma_{xy}$​，列对应各节点：

$$
B= \begin{bmatrix} r_{1,x} & 0 & r_{2,x} & 0 & r_{3,x} & 0 \\ 0 & r_{1,y} & 0 & r_{2,y} & 0 & r_{3,y}\\ r_{1,y} & r_{1,x} & r_{2,y} & r_{2,x} & r_{3,y} & r_{3,x} \end{bmatrix}
$$

再将 $r_{i,x}=b_i/(2A),r_{i,y}=c_i/(2A)$，最终得到三角单元的应变-位移矩阵 $B$ ：
$$
\boxed{ \, B=\frac{1}{2A} \begin{bmatrix} b_1 & 0 & b_2 & 0 & b_3 & 0\\ 0 & c_1 & 0 & c_2 & 0 & c_3\\ c_1 & b_1 & c_2 & b_2 & c_3 & b_3 \end{bmatrix} \, }
$$

我直接使用刚度矩阵 $K$ 的定义：刚度矩阵是 $K$ 是函数空间 $\mathcal{V}$ 上的 *Hodge* 算子,得到 $K$：
$$
K = tAB^TDB
$$

$D$ 是膜单元的弹性模量矩阵，在 [[2.1 二维流形的弹性静力问题]] 中推导：
$$
\mathbf{D}_{mem} = \frac{E}{1-\nu^{2}}\begin{pmatrix}
1&\nu&0 \\
\nu&1&0 \\ 
0&0&\frac{1-\nu}{2} \\
\end{pmatrix}
$$

得到局部应力上的刚度矩阵 $K$ 后，需要将局部刚度矩阵转化为全局坐标系下的刚度矩阵 $\mathbf{K}_{g}$，可以根据三个顶点在全局坐标进行转化得到转化矩阵 $T$

经典 *FEM* 中的小变形假设，是保证单元节点始终“近乎共面”，从而保证局部坐标系、插值函数和应变-位移矩阵的几何结构不随位移改变。在大变形下，四边形单元节点不再共面，单元不再是一个可用二维坐标描述的平面补丁，会形成二面体结构和凹多边形结构，导致插值函数和局部基的几何意义失效。

# 节点等效应力

## 节点等效力公式推导

节点等效力做功和外力场做功是相等的，二维流形嵌入三维空间中，外力做功通用公式：
$$
W = \int_{M} (g_{ij}q^{i}u^{j}+q^{n}u^{n}) dx^{1}{\wedge}dx^{2}
$$

将其写为第二种形式：
$$
W = \int_{M} \mathbf{q} \cdot \mathbf{u} dA
$$

全局单元位移向量：
$$
\mathbf{u}_{e}​=[u_{1x},u_{1y},u_{1z},u_{2x},u_{2y},u_{2z},u_{3x},u_{3y},u_{3z}]^T
$$

嵌入三维空间中节点有 $u_x,u_y,u_z$ 。上文中使用的是矩阵坐标，只用两个自由度，单元自由度为6。局部坐标和全局坐标通过变换矩阵 $T$ 联系在一起。

建立节点函数空间上的位移场描述：

形函数矩阵 $\mathbf{N(x)}(3\times 9)$ ：
$$
\mathbf{N(x)} = [N_{1}(x)\mathbf{I}_{3},N_{2}(x)\mathbf{I}_{3},N_{3}(x)\mathbf{I}_{3}]^T
$$

$\mathbf{I}_{3}$ 是 $3 \times 3$ 矩阵。$\mathbf{N(x)}$ 是一个中间算子，目的是建立函数空间$V=span\{N_{1}(x),N_{2}(x),N_{3}(x)\}$ 到流形 $M$ 之间的映射：
$$
N:V\to M,\quad \mathbf{u(x)}=\mathbf{N(x)}\mathbf{u}_{e}
$$

带入外力功计算公式：
$$
W = \int_{M} \mathbf{q(x)} \cdot \mathbf{N(x)} \mathbf{u}_{e} dA
$$
$\mathbf{u}_{e}$ 项是定义在函数空间 $V$ 上的，所以可以移出去：
$$
W = \mathbf{u}_{e}^T \underbrace{\int_{M} \mathbf{N(x)}^T \cdot\mathbf{q(x)}    dA}_{f^{(e)}}
$$
所以等效力 $f^{(e)}$ 计算公式为：
$$
f^{(e)} =\int_{M} \mathbf{N(x)}^T \cdot\mathbf{q(x)}   dA
$$

## 节点等效力计算

节点等效力 $f^{(e)}$ 取9个自由度，取三角形 $ABC$ 单元内荷载为常数 $\mathbf{q}_{0}(3\times 1)$
带入等效应力公式计算：
$$
f^{(e)} = \int_{M} \mathbf{N}^{T} \cdot \mathbf{q}_{0}dA = \frac{A}{3}
\begin{pmatrix}
q_{0x} \\
q_{0y} \\
q_{0z} \\ 
q_{0x} \\
q_{0y} \\
q_{0z} \\ 
q_{0x} \\
q_{0y} \\
q_{0z} \\
\end{pmatrix}
$$

和1维流形一样列出势能方程变分化简得到：
$$
\mathbf{K}\mathbf{u} = f^{(e)}
$$

# 坐标变换矩阵T

在上文论述中，插值函数被定义在局部坐标系$(v_{1},v_{2})$ 下。这里将建立局部坐标 $(v_{1},v_{2})$  到全局坐标 $(x_{1},x_{2},x_{3})$ 的变换形式。

给定三角形$\triangle_{123}$ 的全局坐标：
$$
\mathbf{x}_{1},\mathbf{x}_{2},\mathbf{x}_{3}
$$

令：
$$
\begin{align}
\mathbf{b_{1}} = \mathbf{x}_{2}-\mathbf{x}_{1} \\
\mathbf{b_{2}} = \mathbf{x}_{3}-\mathbf{x}_{1}
\end{align}
$$

对$\mathbf{b_{1}},\mathbf{b_{2}}$ 做施密特正交化，得到局部正交坐标基 $\mathbf{e}_{1},\mathbf{e}_{2}$

$$
\mathbf{e}_{1} = \frac{\mathbf{b}_{1}}{||\mathbf{b_{1}}||}
\mathbf{e}_{2} = \frac{\mathbf{b_{2}}-(\mathbf{b_{2}} \cdot \mathbf{e_{1}})\mathbf{e_{1}}}{||\mathbf{b_{2}}-(\mathbf{b_{2}} \cdot \mathbf{e_{1}})\mathbf{e_{1}}||}
$$

三个局部点的坐标应该为：

$$
(0,0),(|\mathbf{b}_{1}|,0),(\langle \mathbf{b}_{2},\mathbf{e}_{1} \rangle,\langle \mathbf{b}_{2},\mathbf{e}_{2} \rangle)
$$

将局部坐标系 $(v_{1},v_{2})$ 变换到全局坐标系 $(x_{1},x_{2},x_{3})$ 是一个刚体变换（旋转+平移）。支点全局位移 $\mathbf{u}$ 是计算目标，很明显刚体变换的平移项不影响 $\mathbf{u}$，所以局部坐标位移向量->全局坐标位移向量的变换矩阵 $T$ 是个旋转矩阵。

对应局部坐标系下的点 $(v_{1},v_{2})$ ，其变换矩阵为 $R$ ：
$$
R = \begin{pmatrix}
e_{x1}&e_{x2}  \\
e_{y1}&e_{y2}  \\
e_{z1}&e_{z2}  \\
\end{pmatrix}
$$
将 $R$ 组装为 $T(9\times 6)$ ：
$$
T = \begin{pmatrix}
[R]&0&0 \\
0&[R]&0 \\
0&0&[R]
\end{pmatrix}
$$
 


