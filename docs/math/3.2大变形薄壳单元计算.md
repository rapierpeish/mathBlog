---
title: 3.2 大变形薄壳单元计算
categories: 力学
tags:
  - 壳理论
createTime: 2026/02/01 21:25:18
permalink: /math/laijity1/
---

# 1 引言

经典薄板理论（如 Kirchhoff–Love 或 Reissner–Mindlin 壳理论）通常基于**小变形假设**，即忽略位移梯度的高阶项，从而简化几何关系。然而，在涉及大位移、大转动甚至中等应变的问题中，小变形假设不再适用，必须采用**大变形（几何非线性）壳理论**。

本讲义旨在：
- 回顾经典薄壳理论的基本假设；
- 推广至大变形情形，保留变形前后第一基本形式的完整表达；
- 引入高阶插值（如 NURBS）提升几何与位移场的描述精度；
- 采用严格的分析化方式阐述。

# 2 薄壳理论

## 2.1 几何设定

**参考构型**（即变形前的壳体）：

- 中面由嵌入映射 $\mathbf{r}:U \subset\mathbb{R}^2\to\mathbb{R}^3$ 描述；
- 局部坐标 $(u^1,u^2)$；
- 切向量： $\mathbf{r}_{i}=\partial_{i}\mathbf{r}$；
- 第一基本形式： $g_{ij}=\mathbf{r}_{i}\cdot \mathbf{r}_{j}$。

**当前构型**（变形后的壳体）：

- 变形后中面位置： $\mathbf{r}'=\mathbf{r}+\mathbf{u}(u^1,u^2)$，其中 $\mathbf{u}$ 为三维位移场；
- 切向量： $\mathbf{r}_{i}'=\partial_{i}(\mathbf{r}+\mathbf{u})=\mathbf{r}_{i}+\mathbf{u}$；
- 当前度量：$g_{ij}=\mathbf{r}_{i}'\cdot \mathbf{r}_{j}'$。

## 2.2 几何方程回顾

在 [[3.1 弹性薄壳的几何方程]] 中推导了 Green-Lagrange 应变张量的一般形式：

$$
E_{ij}(u,t)=\frac{1}{2}\left((g_{ij}'-g_{ij})+2t(b_{ij}-b_{ij}')+t^2(\mathbf{n}_{i}' \cdot \mathbf{n}_{j}'-\mathbf{n}_{i}\cdot \mathbf{n}_{j}) \right)
$$

在不考虑扭转和薄壳的假设下，Green-Lagrange 应变张量简化为：

$$
E_{ij}(u) = \frac{1}{2}(g_{ij}-g_{ij}')=\frac{1}{2}(\mathbf{r}_{i}\cdot \mathbf{u}_{j}+\mathbf{r}_{j}\cdot \mathbf{u}_{i}+\mathbf{u}_{i}\cdot \mathbf{u}_{j})
$$

该近似**完全保留了第一基本形式的非线性变化**，足以捕捉由中面拉伸诱导的大位移、大转动引起的几何非线性，同时大幅简化计算。

## 2.3 应力-应变关系

假设材料为各向同性、超弹性，应变能密度 $dW$ 仅为 $E_{ij}$ 的函数：

$$
dW = dW(E_{ij})
$$

使用 [[2.1 二维流形的弹性静力问题]] 中的弹性模量张量公式 $\mathbf{C}_{ijkl}$：

$$
\mathbf{C}_{ijkl} = \lambda \delta_{ij} \delta_{kl} + \mu (\delta_{ik}\delta_{jl}+\delta_{il}\delta_{jk})
$$

其中 $\lambda,\mu$ 为 Lamé 常数。

# 3 Saint Venant–Kirchhoff 应变模型

以下是从弹性模量张量 $\mathbf{C}_{ijkl}$ 出发，结合基本假设，对 Saint Venant–Kirchhoff (SVK) 模型的**完整推导**，得到 SVK 模型下的应变-应力关系，进而计算应变能密度 $dW$。

## 3.1 SVK 模型的核心假设

1. 材料是**线性各向同性弹性**的，用 Green–Lagrange 应变张量来描述变形。
2. 应变能密度是 Green-Lagrange 应变 $\mathbf{E}$ 的二次型。

## 3.2 应力-应变关系

应力-应变关系为：

$$
\mathbf{S} = \lambda (tr\mathbf{E}) I +2\mu \mathbf{E}
$$

- $\mathbf{S}$ 是 [[3.1.1 拉格朗日应力度量#第二类皮奥拉-基尔霍夫应力张量|第二 Piola-Kirchhoff 应力张量]]（2PK）；
- $\lambda, \mu$ 是 **Lamé 常数**；
- $tr \mathbf{E}$ 是应变的迹。

然后通过形变梯度 $\mathbf{F}$ 转化为 Cauchy 应力：

$$
\boldsymbol{\sigma} = \frac{1}{\det \mathbf{F}} \mathbf{F} \mathbf{S} \mathbf{F}^{T}
$$

所以 SVK 模型可以理解为：
- 几何非线性：使用 Green–Lagrange 应变 $\mathbf{E}$；
- 材料本构线性：2PK 应力 $\mathbf{S}$ 与 $\mathbf{E}$ 成线性关系；
- SVK 模型主要用于处理金属板。

## 3.3 SVK 应变能密度

应变能密度为：

$$
W(\mathbf{E}) = \frac{1}{2} \mathbf{E} : \mathbf{C} : \mathbf{E}
$$

分量形式下：

$$
W = \frac{1}{2}(\lambda(tr_{g}E)^2+2\mu E_{ij}E^{kl})
$$

使用逆变度量张量连接 $E^{ij}$ 和 $E_{kl}$：

$$
E^{ij} = g^{ik} g^{jl} E_{kl}
$$

参考构形上的总能量泛函：

$$
II[\varphi] = \int_{\mathcal{B}_{0}} W(E(\varphi)) dA
$$

$dA$ 由第一基本形式计算：

$$
dA = \sqrt{ \det g } x^1 x^2
$$

- $x^1,x^2$ 是局部坐标。

# 4 刚度矩阵

本节首先给出两种刚度矩阵的定义方式：
- 从能量视角出发，将刚度矩阵视为总势能泛函在当前构形处的**二阶变分**。

通过严格推导，最后得到：
- 刚度矩阵正是能量泛函在配置空间上所诱导的自然度量，而其在有限变形理论中**必然分裂为材料刚度与几何刚度两部分**；
- 离散材料刚度计算公式和离散几何刚度计算公式。

## 4.1 刚度矩阵定义

刚度矩阵的严格定义：
> 刚度矩阵 $K$ 是线弹性系统中，联系广义节点力 $F$ 与广义节点位移 $q$ 的线性对称正定算子，其数学本质是系统应变能泛函关于节点位移向量的 Hessian 矩阵。

在有限元框架下具体表现为：

$$
K = \int \mathbf{B}^T\mathbf{C} \mathbf{B} dA
$$

### 4.1.1 刚度矩阵作为函数空间上的内积

设中面位移场属于函数空间：

$$
\mathbf{u} \in \mathcal{V},\quad \mathcal{V}\subset H^{1}(\mathcal{M},\mathbb{R}^3)
$$

在离散情形下，取有限维子空间 $\mathcal{V}_h$，位移场基函数展开为

$$
\mathbf{u}_{h} = \sum_{a} d_{i} \phi_{i}
$$

- $d_{i}$：位移向量分量；
- $\phi_{i}$：基函数向量分量。

在 2.1 章中，刚度矩阵 $K$ 是直接由函数空间内积给出的，其对应的离散弹性势能写为

$$
U_{h}=\frac{1}{2}\mathbf{d}^{T}\left[\int_{\mathcal{M}}EI \mathbf{B}^{T}(x)\mathbf{B}(x) dx  \right] \mathbf{d}
$$

在此式中：
- 括号部分就是刚度矩阵 $K$ 的离散定义；
- $\mathbf{B}(x)$ 是应变–位移算子在离散基下的矩阵表示。

在有限弹性理论中，系统的力学行为由总势能泛函控制：

$$
\Pi(\mathbf{u}) = \int_{M_{0}} W(E(\mathbf{u})) dA - \ell(\mathbf{u})
$$

其中：
- $E(\mathbf{u})$ 为 Green–Lagrange 应变张量；
- $W(E)$ 为 SVK 模型下的应变能密度；
- $\ell(\mathbf{u})$ 为外力势。

根据变分原理：

$$
\delta\Pi(\mathbf{u})[\delta \mathbf{u}] = 0
$$

若 $\mathbf{u}$ 为平衡解，则总势能在该点的一阶变分为零，其**二阶变分**自然定义为

$$
\delta^2 \Pi (\mathbf{u}) [\delta \mathbf{u},\mathbf{v}]=\delta_{v}(\delta_{u}\Pi[\mathbf{u}])
$$

因此我们可以反过来得到刚度矩阵的一般定义：

$$
K(\delta \mathbf{u,\mathbf{v}}) := \delta^2 \Pi (\mathbf{u}) [\delta \mathbf{u},\mathbf{v}]
$$

## 4.2 能量二阶变分的推导

接下来将严格推导 $\delta^2 \Pi$ 的结构。

**一阶变分** $\delta \Pi$：

$$
\delta \Pi=\int_{\mathcal{M}_{0}} \frac{\partial W}{\partial E}: \delta E dA
$$

- $\mathcal{M}_{0}$ 是初始构型（流形），拉格朗日度量讨论范围需限定在此，接下来的 Piola-Kirchhoff 应力才有意义。

根据第二 Piola-Kirchhoff 应力定义：

$$
\mathbf{S}:= \frac{\partial W}{\partial E}
$$

得到：

$$
\delta \Pi = \int_{M_{0}} \mathbf{S}:\delta E dA
$$

**二阶变分** $\delta^2 \Pi$：

再次对 $\delta \Pi$ 取变分，根据链式法则：

$$
\delta^2\Pi=\int_{\mathcal{M_{0}}} (\delta E:\mathbb{C}:\delta E+\mathbf{S}:\delta^2E) dA.
$$

其中：

$$
\mathbb{C} := \frac{\partial^2 W}{\partial E^2}
$$

是材料的四阶弹性张量。

由上式，刚度矩阵自然分解为两部分：

$$
K = K^{mat}+K^{geo}
$$

**材料刚度**：

$$
K^{mat}(\delta \mathbf{u},\mathbf{v}) = \int_{\mathcal{M_{0}}} \delta E(\delta u) : \mathbb{C} : \delta E
$$

- 来源于应变能密度 $W(E)$ 的二阶导数；
- 即使在小变形理论中仍然存在；
- 对应于材料本构关系诱导的度量。

**几何刚度**：

$$
K^{geo} (\delta \mathbf{u},\mathbf{v}) = \int_{\mathcal{M_{0}}} \mathbf{S}:\delta^2E(\delta \mathbf{u},\mathbf{v}) dA
$$

# 5 刚度离散计算

## 5.1 前文重要结论

应变能密度的二阶泛函：

$$
\delta^2\Pi=\int_{\mathcal{M_{0}}} (\delta E:\mathbb{C}:\delta E+\mathbf{S}:\delta^2E) dA.
$$

应变张量使用：

$$
E_{ij}(u) = \frac{1}{2}(g_{ij}-g_{ij}')=\frac{1}{2}(\mathbf{r}_{i}\cdot \mathbf{u}_{j}+\mathbf{r}_{j}\cdot \mathbf{u}_{i}+\mathbf{u}_{i}\cdot \mathbf{u}_{j})
$$

本章节将在这两个结论基础上，使用高阶 NURBS 函数插值计算三角单元的材料刚度矩阵和几何刚度矩阵。

## 5.2 位移场的 NURBS 插值

设单元内位移场 $\mathbf u(\xi_{i})$ 用 NURBS 曲面基函数插值，此处采用位移型参数化，基本未知量为中面位移 $\mathbf{u}(x_{i})\in\mathbb{R}^3$，因此控制点仅具有 3 个平移自由度，而无需引入独立转角自由度。

$$
u(x)^{\alpha} = \phi^{\alpha}(x)d_{k}^{\alpha}
$$

- $\alpha = 1,2,3$ 空间分量；
- $k$：自由度编号。

位移导数：

$$
u_{i}^{\alpha} := \frac{\partial u^{\alpha}}{\partial x_{i}}= \frac{\partial \phi^{k}}{\partial x_{i}} d_{k}^{\alpha}
$$

变分：

$$
\delta u_{i}^{\alpha} =  \frac{\partial \phi^{k}}{\partial x_{i}} \delta d_{k}^{\alpha}
$$

所有推导都在这个约定下进行。

## 5.3 应变张量及其变分

应变张量使用：

$$
E_{ij}(u) = \frac{1}{2}(g_{ij}-g_{ij}')=\frac{1}{2}(\mathbf{r}_{i}\cdot \mathbf{u}_{j}+\mathbf{r}_{j}\cdot \mathbf{u}_{i}+\mathbf{u}_{i}\cdot \mathbf{u}_{j})
$$

- $\mathbf{r}_{i}$ 是参考构型中面上任意点 $\mathcal{p}$ 处的切向量；
- $\mathbf{u}_{i}$ 是位移场矢量的分量。

对 $\mathbf{u}$ 计算 Gateaux 导数：

$$
\delta E_{ij} = \frac{1}{2}(\mathbf{r}_{i} \cdot \delta \mathbf{u}_{j} + \mathbf{r}_{j} \cdot \delta \mathbf{u}_{i}+ \delta \mathbf{u}_{i} \cdot \mathbf{u}_{j}+ \mathbf{u}_{i} \cdot \delta \mathbf{u}_{j})
$$

展开为分量形式：

$$
\delta E_{ij} = \frac{1}{2}(r_{i}^{\alpha} \cdot  \delta u_{j}^{\alpha} + r_{j}^{\alpha} \cdot  \delta u_{i}^{\alpha}+\delta u_{i}^{\alpha} \cdot u_{j}^{\alpha} + u_{i}^{\alpha} \cdot \delta u_{j}^{\alpha})
$$

### 5.3.1 离散化应变张量

将离散变分代入：

$$
\delta u_{i}^{\alpha} =  \frac{\partial \phi^{k}}{\partial x_{i}} \delta d_{k}^{\alpha}
$$

得到：

$$
\delta E_{ij} = \frac12 \Big[ \Big( r_i^\alpha \frac{\partial \phi^k}{\partial x_j} + r_j^\alpha \frac{\partial \phi^k}{\partial x_i} + u_j^\alpha \frac{\partial \phi^k}{\partial x_i} + u_i^\alpha \frac{\partial \phi^k}{\partial x_j} \Big) \delta d_k^\alpha \Big]
$$

定义应变-位移算子 $B_{ij}^{k}$ 满足：

$$
\delta E_{ij} = B_{ij}^{k} \cdot \delta d_{k}
$$

所以应变-位移算子就是上面括号中的系数：

$$
B_{ij}^k = \frac{1}{2} \Big( r_i^\alpha \frac{\partial \phi^k}{\partial x_j} + r_j^\alpha \frac{\partial \phi^k}{\partial x_i} + u_j^\alpha \frac{\partial \phi^k}{\partial x_i} + u_i^\alpha \frac{\partial \phi^k}{\partial x_j} \Big)
$$

或者用向量形式更紧凑地写成：

$$
B_{ij}^k = \frac12\Big( \mathbf r_i\, \phi^k_{,j} + \mathbf r_j\, \phi^k_{,i} + \mathbf u_j\, \phi^k_{,i} + \mathbf u_i\, \phi^k_{,j} \Big)
$$

## 5.4 离散材料刚度矩阵

材料刚度来自二阶变分第一项：

$$
\delta^2 \Pi_{mat} = \int_{\mathcal{M_{0}}} \delta E:\mathbb{C}:\delta E dA
$$

将 $\delta E_{ij} = B_{ij}^k \cdot \delta d_{k}$ 代入，得到离散材料刚度矩阵的分量形式：

$$
\delta^2 \Pi_{mat} = \sum_{m,n} \delta d_{m} \left[  \int_{\mathcal{M_{0}}} B_{ij}^{m} C^{ijkl} B_{kl}^{n} \right] \cdot \delta d_{n}
$$

## 5.5 离散几何刚度矩阵

从定义出发直接计算二阶变分：

$$
\delta^2 E_{ij} = \frac{1}{2} (\delta \mathbf{u}_{i} \cdot \delta \mathbf{u}_{j} + \delta \mathbf{u}_{j} \cdot \delta \mathbf{u}_{i}) = \delta \mathbf{u}_{i} \cdot \delta \mathbf{u}_{j}
$$

代入分量：

$$
\delta u_{i}^{\alpha} =  \frac{\partial \phi^{k}}{\partial x_{i}} \delta d_{k}^{\alpha}
$$

得到：

$$
\delta^2 E_{ij} = \frac{\partial \phi^k}{\partial x_{i}} \cdot \frac{\partial \phi^k}{\partial x_{j}} (\delta d_{k}^{\alpha})^2
$$

几何刚度定义：

$$
\delta^2\Pi_{geo} = \int_{M_{0}} \mathbf{S}: \delta^2 \mathbf{E} dA
$$

代入得到连续分量形式：

$$
\delta^2\Pi_{geo} =\int_{\mathcal{M_{0}}} S^{ij} \delta^2 E_{ij} dA
$$

代入离散插值：

$$
\delta^2\Pi_{geo} = \sum_{m,n} \delta d_{m} \cdot \left[ \int_{\mathcal{M_{0}}} S^{ij} \frac{\partial \phi^m}{\partial x_{i}} \frac{\partial \phi^n}{\partial x_{j}} dA\right] \cdot \delta d_{n}
$$

## 5.6 结论

本章从刚度矩阵的定义——刚度矩阵是应变能的二阶泛函——出发，推导出：

**材料刚度矩阵**为：

$$
\delta^2 \Pi_{mat} = \sum_{m,n} \delta d_{m} \left[  \int_{\mathcal{M_{0}}} B_{ij}^{m} C^{ijkl} B_{kl}^{n} \right] \cdot \delta d_{n}
$$

**几何刚度矩阵**为：

$$
\delta^2\Pi_{geo} = \sum_{m,n} \delta d_{m} \cdot \left[ \int_{\mathcal{M_{0}}} S^{ij} \frac{\partial \phi^m}{\partial x_{i}} \frac{\partial \phi^n}{\partial x_{j}} dA\right] \cdot \delta d_{n}
$$
